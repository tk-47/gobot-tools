# =============================================================================
# Security Sentinel — Configuration
# =============================================================================
# Copy this file to .env and fill in your values.
# All values have sensible defaults — only VPS_URL is truly required.

# --- Target Infrastructure ---
VPS_URL=https://your-domain.example.com       # Public URL of your VPS (REQUIRED)
VPS_SSH_HOST=0.0.0.0                           # VPS IP address for SSH + nmap
VPS_SSH_USER=deploy                            # SSH username
VPS_SSH_KEY=~/.ssh/id_ed25519                  # Path to SSH private key
VPS_PROJECT_DIR=/home/deploy/myproject         # Project directory on VPS

# --- Domain & DNS ---
DOMAIN=example.com                             # Your domain (for cert transparency + DNS checks)

# --- Local Project ---
# GO_PROJECT_ROOT=/path/to/local/project       # Local project root (defaults to cwd)

# --- Webhook Endpoints to Test (comma-separated paths) ---
# Each entry: path:method:auth_type
# auth_type: signature (HMAC/JWT), bearer, none
WEBHOOK_ENDPOINTS=/webhook:POST:signature,/deploy:POST:signature,/api/messages:POST:signature

# --- Disabled Endpoints (should return 404) ---
DISABLED_ENDPOINTS=/context,/webhook/elevenlabs

# --- Sensitive Paths to Check (should return 404/403) ---
# SENSITIVE_PATHS=/.env,/.git/config,/node_modules,/.env.local

# --- Expected Open Ports (comma-separated) ---
# EXPECTED_PORTS=22,80,443

# --- PM2 Process Name ---
PM2_PROCESS_NAME=my-app

# --- Rate Limiting ---
# RATE_LIMIT_THRESHOLD=30                      # Expected rate limit (requests/minute)
# RATE_LIMIT_PROBE_COUNT=35                    # Number of requests to send

# --- Notifications ---
TELEGRAM_BOT_TOKEN=                            # Telegram bot token for alerts
TELEGRAM_USER_ID=                              # Your Telegram user ID for alerts

# --- AI Review ---
OLLAMA_URL=http://localhost:11434              # Ollama API URL
SECURITY_OLLAMA_MODEL=qwen3:8b                # Local model for hourly/daily review
ANTHROPIC_API_KEY=                             # Anthropic API key for deep scan
SECURITY_CLAUDE_MODEL=claude-sonnet-4-5-20250929  # Claude model for deep analysis

# --- API Credentials to Validate (optional) ---
# The scanner will test these against their respective APIs if set.
# TELEGRAM_BOT_TOKEN is already above.
# ANTHROPIC_API_KEY is already above.
# CONVEX_URL=https://your-project.convex.cloud
# MS365_REFRESH_TOKEN=
# OPENAI_API_KEY=

# --- GitHub Repo (for TruffleHog) ---
# GITHUB_REPO=https://github.com/your-org/your-repo

# --- Local Security Checks ---
# SUBPROCESS_SOURCE_FILE=src/lib/claude.ts     # File to check for dangerous permissions
# GATEWAY_SECRET=                              # Gateway shared secret (checked for entropy)

# --- Timezone ---
TIMEZONE=America/Chicago
